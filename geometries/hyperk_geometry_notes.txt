================================================================================
Hyper-Kamiokande Geometry File Analysis
================================================================================

Source file: Hyper_K_blablabla.txt
Analysis date: December 2024

================================================================================
DETECTOR DIMENSIONS
================================================================================

Radius: 3242.96 cm
Height: 6701.41 cm
Center offset: (0.00, 0.00, 0.00)

================================================================================
PMT SUMMARY FROM HEADER
================================================================================

Type 1 ID PMTs:  19,746 PMTs @ 25.40 cm diameter (~10 inch, called "20 inch")
Type 2 ID PMTs:  15,504 PMTs @  4.00 cm diameter (mPMTs / small PMTs)
OD PMTs:          3,532 PMTs @ 101.60 cm diameter (Outer Detector)

================================================================================
DETAILED PMT TYPE ANALYSIS
================================================================================

Type | Count  | Z range (cm)       | R range (cm)      | dir_z    | Description
-----|--------|--------------------|-------------------|----------|------------------
  0  |  3,249 | +3296.5 to +3296.5 |    0.0 to 3209.0  | -1.0     | ID Top Cap (20")
  1  | 13,248 | -3250.0 to +3182.2 | 3243.0 to 3243.0  |  0.0     | ID Barrel (20")
  2  |  3,248 | -3296.5 to -3296.5 |    0.0 to 3209.0  | +1.0     | ID Bottom Cap (20")
-----|--------|--------------------|-------------------|----------|------------------
  3  |    542 | +3350.7 to +3350.7 |  141.2 to 3201.2  | -1.0     | OD Top Cap
  4  |  2,448 | -3285.4 to +3076.2 | 3305.2 to 3305.2  |  0.0     | OD Barrel
  5  |    542 | -3350.7 to -3350.7 |  141.2 to 3201.2  | +1.0     | OD Bottom Cap
-----|--------|--------------------|-------------------|----------|------------------
  6  |  2,508 | +3279.3 to +3284.5 |  336.9 to 3214.8  | -0.8,-1.0| mPMT Top Cap
  7  | 10,488 | -3266.1 to +2986.3 | 3225.7 to 3231.0  | various  | mPMT Barrel
  8  |  2,508 | -3284.5 to -3279.3 |  336.9 to 3214.8  | +0.8,+1.0| mPMT Bottom Cap
-----|--------|--------------------|-------------------|----------|------------------
     | 38,781 |                    |                   |          | TOTAL

================================================================================
PARSED OUTPUT FILES
================================================================================

Generated by parse_hyperk_geometry.py:

1. hyperk_20inch_pmts.csv (legacy)
   - Basic columns: tube_id, x, y, z, r, theta, dir_x, dir_y, dir_z, region

2. hyperk_20inch_pmts_cyl_coords.csv (recommended for ML/DL)
   - Extended columns including pre-computed trigonometric values
   - Columns: tube_id, x, y, z, r, theta, cos_theta, sin_theta, 
              dir_x, dir_y, dir_z, region
   - cos_theta and sin_theta pre-computed for neural network efficiency

================================================================================
20" INNER DETECTOR PMTs (Types 0, 1, 2)
================================================================================

These are the main PMTs for physics analysis.

Total: 19,746 PMTs

Structure:
- Top cap:    Type 0, 3,249 PMTs at z = +3296.5 cm, pointing DOWN (dir_z = -1)
- Barrel:     Type 1, 13,248 PMTs at r = 3243 cm, pointing INWARD (dir_z = 0)
- Bottom cap: Type 2, 3,248 PMTs at z = -3296.5 cm, pointing UP (dir_z = +1)

Geometry:
- Caps are flat disks with PMTs distributed on a Cartesian-like grid
- Barrel is a cylinder with PMTs at constant radius
- Direction vector always points INTO the detector volume

================================================================================
OUTER DETECTOR PMTs (Types 3, 4, 5)
================================================================================

Total: 3,532 PMTs

Larger PMTs (101.60 cm diameter) surrounding the inner detector.
- Top cap:    Type 3, 542 PMTs at z = +3350.7 cm
- Barrel:     Type 4, 2,448 PMTs at r = 3305.2 cm
- Bottom cap: Type 5, 542 PMTs at z = -3350.7 cm

================================================================================
mPMTs / SMALL PMTs (Types 6, 7, 8)
================================================================================

Total: 15,504 PMTs

These are 4 cm diameter multi-PMT modules.
- Type 6: Top cap region, 2,508 PMTs
- Type 7: Barrel region, 10,488 PMTs (various directions due to multi-anode)
- Type 8: Bottom cap region, 2,508 PMTs

Note: dir_z varies for mPMTs as they have multiple anodes pointing different directions.

================================================================================
FILE FORMAT
================================================================================

Header (lines 1-5):
  Line 1: "Detector radius & height  <radius> <height>"
  Line 2: "Type 1 ID PMT number & size  <count> <diameter>"
  Line 3: "Type 2 ID PMT number & size  <count> <diameter>"
  Line 4: "OD PMT number & size  <count> <diameter>"
  Line 5: "Centre offset  <x> <y> <z>"

Data (lines 6+):
  Columns: tube_id  secondary_id  flag  x  y  z  dir_x  dir_y  dir_z  type

  - tube_id: Unique PMT identifier
  - secondary_id: Secondary identifier (often same as tube_id)
  - flag: Unknown flag (typically 0 or small int)
  - x, y, z: Position in cm
  - dir_x, dir_y, dir_z: Direction unit vector (pointing into detector)
  - type: PMT type (0-8, see above)

================================================================================
COORDINATE SYSTEM
================================================================================

- Origin: Center of detector
- Z-axis: Vertical (cylinder axis)
- X, Y: Horizontal plane

Cylindrical coordinates:
- r = sqrt(x² + y²)
- θ = atan2(y, x)  (azimuthal angle)
- z = z (height)

Pre-computed cylindrical coordinates (available in *_cyl_coords.csv):
- r: Radial distance from z-axis (cm)
- theta: Azimuthal angle (radians, range: -π to +π)
- cos_theta: Cosine of azimuthal angle
- sin_theta: Sine of azimuthal angle

Note: cos_theta and sin_theta are pre-computed for neural network training
      to avoid repeated trigonometric calculations during data loading.

================================================================================
USEFUL VALUES FOR VOXELIZATION
================================================================================

Z boundaries (for region classification):
- Bottom cap: z < -3200 cm
- Barrel: -3200 cm ≤ z ≤ +3200 cm
- Top cap: z > +3200 cm

Barrel dimensions:
- Radius: ~3243 cm (constant)
- Height: ~6400 cm (-3200 to +3200)

Cap dimensions:
- Radius: 0 to ~3200 cm
- Z positions: ±3296.5 cm

================================================================================

